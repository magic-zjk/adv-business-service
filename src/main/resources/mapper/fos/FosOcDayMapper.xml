<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.imopan.adv.platform.mapper.fos.FosOcDayMapper">
  <resultMap id="BaseResultMap" type="com.imopan.adv.platform.entity.fos.FosOcDay">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="ID" jdbcType="INTEGER" property="id" />
    <result column="CHANNEL_ORDER_ID" jdbcType="INTEGER" property="channelOrderId" />
    <result column="ORDER_ID" jdbcType="INTEGER" property="orderId" />
    <result column="ORDER_NAME" jdbcType="VARCHAR" property="orderName" />
    <result column="PRODUCT_NAME" jdbcType="VARCHAR" property="productName" />
    <result column="COOPERATE_NAME" jdbcType="VARCHAR" property="cooperateName" />
    <result column="ORDER_DIRECTOR_NAME" jdbcType="VARCHAR" property="orderDirectorName" />
    <result column="CP_MAIN" jdbcType="TINYINT" property="cpMain" />
    <result column="PAY_UNIT" jdbcType="DECIMAL" property="payUnit" />
    <result column="O_COUNT" jdbcType="INTEGER" property="oCount" />
    <result column="O_AMOUNT" jdbcType="DECIMAL" property="oAmount" />
    <result column="CHANNEL_ID" jdbcType="INTEGER" property="channelId" />
    <result column="CHANNEL_NAME" jdbcType="VARCHAR" property="channelName" />
    <result column="OUTER_UNIT" jdbcType="DECIMAL" property="outerUnit" />
    <result column="C_COUNT" jdbcType="INTEGER" property="cCount" />
    <result column="C_AMOUNT" jdbcType="DECIMAL" property="cAmount" />
    <result column="CHANNEL_DIRECTOR_NAME" jdbcType="VARCHAR" property="channelDirectorName" />
    <result column="ENTRY_DAY_STATUS" jdbcType="TINYINT" property="entryDayStatus" />
    <result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
    <result column="MODIFY_TIME" jdbcType="TIMESTAMP" property="modifyTime" />
    <result column="OC_DAY_STATUS" jdbcType="TINYINT" property="ocDayStatus" />
    <result column="ENTRY_TIME" jdbcType="DATE" property="entryTime" />
    <result column="CHANNEL_MONTH_STATUS" jdbcType="TINYINT" property="channelMonthStatus" />
    <result column="AVG_MEDIA_REBATE" jdbcType="DECIMAL" property="avgMediaRebate" />
    <result column="AVG_OTHER_EXPENSE" jdbcType="DECIMAL" property="avgOtherExpense" />
    <result column="AVG_CHANNEL_CUT" jdbcType="DECIMAL" property="avgChannelCut" />
    <result column="ORDER_MONTH_STATUS" jdbcType="TINYINT" property="orderMonthStatus" />
  </resultMap>
  <sql id="Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <where>
      <foreach collection="oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    ID, CHANNEL_ORDER_ID, ORDER_ID, ORDER_NAME, PRODUCT_NAME, COOPERATE_NAME, ORDER_DIRECTOR_NAME, 
    CP_MAIN, PAY_UNIT, O_COUNT, O_AMOUNT, CHANNEL_ID, CHANNEL_NAME, OUTER_UNIT, C_COUNT, 
    C_AMOUNT, CHANNEL_DIRECTOR_NAME, ENTRY_DAY_STATUS, CREATE_TIME, MODIFY_TIME, OC_DAY_STATUS, 
    ENTRY_TIME, CHANNEL_MONTH_STATUS, AVG_MEDIA_REBATE, AVG_OTHER_EXPENSE, AVG_CHANNEL_CUT, 
    ORDER_MONTH_STATUS
  </sql>
  <select id="selectByExample" parameterType="com.imopan.adv.platform.entity.fos.FosOcDayExample" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    'false' as QUERYID,
    <include refid="Base_Column_List" />
    from fos_oc_day
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
    <if test="limitStart != null and limitStart&gt;=0">
      limit #{limitStart} , #{limitEnd}
    </if>
  </select>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from fos_oc_day
    where ID = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from fos_oc_day
    where ID = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" keyColumn="ID" keyProperty="id" parameterType="com.imopan.adv.platform.entity.fos.FosOcDay" useGeneratedKeys="true">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into fos_oc_day (CHANNEL_ORDER_ID, ORDER_ID, ORDER_NAME, 
      PRODUCT_NAME, COOPERATE_NAME, ORDER_DIRECTOR_NAME, 
      CP_MAIN, PAY_UNIT, O_COUNT, 
      O_AMOUNT, CHANNEL_ID, CHANNEL_NAME, 
      OUTER_UNIT, C_COUNT, C_AMOUNT, 
      CHANNEL_DIRECTOR_NAME, ENTRY_DAY_STATUS, CREATE_TIME, 
      MODIFY_TIME, OC_DAY_STATUS, ENTRY_TIME, 
      CHANNEL_MONTH_STATUS, AVG_MEDIA_REBATE, AVG_OTHER_EXPENSE, 
      AVG_CHANNEL_CUT, ORDER_MONTH_STATUS)
    values (#{channelOrderId,jdbcType=INTEGER}, #{orderId,jdbcType=INTEGER}, #{orderName,jdbcType=VARCHAR}, 
      #{productName,jdbcType=VARCHAR}, #{cooperateName,jdbcType=VARCHAR}, #{orderDirectorName,jdbcType=VARCHAR}, 
      #{cpMain,jdbcType=TINYINT}, #{payUnit,jdbcType=DECIMAL}, #{oCount,jdbcType=INTEGER}, 
      #{oAmount,jdbcType=DECIMAL}, #{channelId,jdbcType=INTEGER}, #{channelName,jdbcType=VARCHAR}, 
      #{outerUnit,jdbcType=DECIMAL}, #{cCount,jdbcType=INTEGER}, #{cAmount,jdbcType=DECIMAL}, 
      #{channelDirectorName,jdbcType=VARCHAR}, #{entryDayStatus,jdbcType=TINYINT}, #{createTime,jdbcType=TIMESTAMP}, 
      #{modifyTime,jdbcType=TIMESTAMP}, #{ocDayStatus,jdbcType=TINYINT}, #{entryTime,jdbcType=DATE}, 
      #{channelMonthStatus,jdbcType=TINYINT}, #{avgMediaRebate,jdbcType=DECIMAL}, #{avgOtherExpense,jdbcType=DECIMAL}, 
      #{avgChannelCut,jdbcType=DECIMAL}, #{orderMonthStatus,jdbcType=TINYINT})
  </insert>
  <insert id="insertSelective" keyColumn="ID" keyProperty="id" parameterType="com.imopan.adv.platform.entity.fos.FosOcDay" useGeneratedKeys="true">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into fos_oc_day
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="channelOrderId != null">
        CHANNEL_ORDER_ID,
      </if>
      <if test="orderId != null">
        ORDER_ID,
      </if>
      <if test="orderName != null">
        ORDER_NAME,
      </if>
      <if test="productName != null">
        PRODUCT_NAME,
      </if>
      <if test="cooperateName != null">
        COOPERATE_NAME,
      </if>
      <if test="orderDirectorName != null">
        ORDER_DIRECTOR_NAME,
      </if>
      <if test="cpMain != null">
        CP_MAIN,
      </if>
      <if test="payUnit != null">
        PAY_UNIT,
      </if>
      <if test="oCount != null">
        O_COUNT,
      </if>
      <if test="oAmount != null">
        O_AMOUNT,
      </if>
      <if test="channelId != null">
        CHANNEL_ID,
      </if>
      <if test="channelName != null">
        CHANNEL_NAME,
      </if>
      <if test="outerUnit != null">
        OUTER_UNIT,
      </if>
      <if test="cCount != null">
        C_COUNT,
      </if>
      <if test="cAmount != null">
        C_AMOUNT,
      </if>
      <if test="channelDirectorName != null">
        CHANNEL_DIRECTOR_NAME,
      </if>
      <if test="entryDayStatus != null">
        ENTRY_DAY_STATUS,
      </if>
      <if test="createTime != null">
        CREATE_TIME,
      </if>
      <if test="modifyTime != null">
        MODIFY_TIME,
      </if>
      <if test="ocDayStatus != null">
        OC_DAY_STATUS,
      </if>
      <if test="entryTime != null">
        ENTRY_TIME,
      </if>
      <if test="channelMonthStatus != null">
        CHANNEL_MONTH_STATUS,
      </if>
      <if test="avgMediaRebate != null">
        AVG_MEDIA_REBATE,
      </if>
      <if test="avgOtherExpense != null">
        AVG_OTHER_EXPENSE,
      </if>
      <if test="avgChannelCut != null">
        AVG_CHANNEL_CUT,
      </if>
      <if test="orderMonthStatus != null">
        ORDER_MONTH_STATUS,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="channelOrderId != null">
        #{channelOrderId,jdbcType=INTEGER},
      </if>
      <if test="orderId != null">
        #{orderId,jdbcType=INTEGER},
      </if>
      <if test="orderName != null">
        #{orderName,jdbcType=VARCHAR},
      </if>
      <if test="productName != null">
        #{productName,jdbcType=VARCHAR},
      </if>
      <if test="cooperateName != null">
        #{cooperateName,jdbcType=VARCHAR},
      </if>
      <if test="orderDirectorName != null">
        #{orderDirectorName,jdbcType=VARCHAR},
      </if>
      <if test="cpMain != null">
        #{cpMain,jdbcType=TINYINT},
      </if>
      <if test="payUnit != null">
        #{payUnit,jdbcType=DECIMAL},
      </if>
      <if test="oCount != null">
        #{oCount,jdbcType=INTEGER},
      </if>
      <if test="oAmount != null">
        #{oAmount,jdbcType=DECIMAL},
      </if>
      <if test="channelId != null">
        #{channelId,jdbcType=INTEGER},
      </if>
      <if test="channelName != null">
        #{channelName,jdbcType=VARCHAR},
      </if>
      <if test="outerUnit != null">
        #{outerUnit,jdbcType=DECIMAL},
      </if>
      <if test="cCount != null">
        #{cCount,jdbcType=INTEGER},
      </if>
      <if test="cAmount != null">
        #{cAmount,jdbcType=DECIMAL},
      </if>
      <if test="channelDirectorName != null">
        #{channelDirectorName,jdbcType=VARCHAR},
      </if>
      <if test="entryDayStatus != null">
        #{entryDayStatus,jdbcType=TINYINT},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="modifyTime != null">
        #{modifyTime,jdbcType=TIMESTAMP},
      </if>
      <if test="ocDayStatus != null">
        #{ocDayStatus,jdbcType=TINYINT},
      </if>
      <if test="entryTime != null">
        #{entryTime,jdbcType=DATE},
      </if>
      <if test="channelMonthStatus != null">
        #{channelMonthStatus,jdbcType=TINYINT},
      </if>
      <if test="avgMediaRebate != null">
        #{avgMediaRebate,jdbcType=DECIMAL},
      </if>
      <if test="avgOtherExpense != null">
        #{avgOtherExpense,jdbcType=DECIMAL},
      </if>
      <if test="avgChannelCut != null">
        #{avgChannelCut,jdbcType=DECIMAL},
      </if>
      <if test="orderMonthStatus != null">
        #{orderMonthStatus,jdbcType=TINYINT},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.imopan.adv.platform.entity.fos.FosOcDayExample" resultType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select count(*) from fos_oc_day
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update fos_oc_day
    <set>
      <if test="record.id != null">
        ID = #{record.id,jdbcType=INTEGER},
      </if>
      <if test="record.channelOrderId != null">
        CHANNEL_ORDER_ID = #{record.channelOrderId,jdbcType=INTEGER},
      </if>
      <if test="record.orderId != null">
        ORDER_ID = #{record.orderId,jdbcType=INTEGER},
      </if>
      <if test="record.orderName != null">
        ORDER_NAME = #{record.orderName,jdbcType=VARCHAR},
      </if>
      <if test="record.productName != null">
        PRODUCT_NAME = #{record.productName,jdbcType=VARCHAR},
      </if>
      <if test="record.cooperateName != null">
        COOPERATE_NAME = #{record.cooperateName,jdbcType=VARCHAR},
      </if>
      <if test="record.orderDirectorName != null">
        ORDER_DIRECTOR_NAME = #{record.orderDirectorName,jdbcType=VARCHAR},
      </if>
      <if test="record.cpMain != null">
        CP_MAIN = #{record.cpMain,jdbcType=TINYINT},
      </if>
      <if test="record.payUnit != null">
        PAY_UNIT = #{record.payUnit,jdbcType=DECIMAL},
      </if>
      <if test="record.oCount != null">
        O_COUNT = #{record.oCount,jdbcType=INTEGER},
      </if>
      <if test="record.oAmount != null">
        O_AMOUNT = #{record.oAmount,jdbcType=DECIMAL},
      </if>
      <if test="record.channelId != null">
        CHANNEL_ID = #{record.channelId,jdbcType=INTEGER},
      </if>
      <if test="record.channelName != null">
        CHANNEL_NAME = #{record.channelName,jdbcType=VARCHAR},
      </if>
      <if test="record.outerUnit != null">
        OUTER_UNIT = #{record.outerUnit,jdbcType=DECIMAL},
      </if>
      <if test="record.cCount != null">
        C_COUNT = #{record.cCount,jdbcType=INTEGER},
      </if>
      <if test="record.cAmount != null">
        C_AMOUNT = #{record.cAmount,jdbcType=DECIMAL},
      </if>
      <if test="record.channelDirectorName != null">
        CHANNEL_DIRECTOR_NAME = #{record.channelDirectorName,jdbcType=VARCHAR},
      </if>
      <if test="record.entryDayStatus != null">
        ENTRY_DAY_STATUS = #{record.entryDayStatus,jdbcType=TINYINT},
      </if>
      <if test="record.createTime != null">
        CREATE_TIME = #{record.createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.modifyTime != null">
        MODIFY_TIME = #{record.modifyTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.ocDayStatus != null">
        OC_DAY_STATUS = #{record.ocDayStatus,jdbcType=TINYINT},
      </if>
      <if test="record.entryTime != null">
        ENTRY_TIME = #{record.entryTime,jdbcType=DATE},
      </if>
      <if test="record.channelMonthStatus != null">
        CHANNEL_MONTH_STATUS = #{record.channelMonthStatus,jdbcType=TINYINT},
      </if>
      <if test="record.avgMediaRebate != null">
        AVG_MEDIA_REBATE = #{record.avgMediaRebate,jdbcType=DECIMAL},
      </if>
      <if test="record.avgOtherExpense != null">
        AVG_OTHER_EXPENSE = #{record.avgOtherExpense,jdbcType=DECIMAL},
      </if>
      <if test="record.avgChannelCut != null">
        AVG_CHANNEL_CUT = #{record.avgChannelCut,jdbcType=DECIMAL},
      </if>
      <if test="record.orderMonthStatus != null">
        ORDER_MONTH_STATUS = #{record.orderMonthStatus,jdbcType=TINYINT},
      </if>
    </set>
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update fos_oc_day
    set ID = #{record.id,jdbcType=INTEGER},
      CHANNEL_ORDER_ID = #{record.channelOrderId,jdbcType=INTEGER},
      ORDER_ID = #{record.orderId,jdbcType=INTEGER},
      ORDER_NAME = #{record.orderName,jdbcType=VARCHAR},
      PRODUCT_NAME = #{record.productName,jdbcType=VARCHAR},
      COOPERATE_NAME = #{record.cooperateName,jdbcType=VARCHAR},
      ORDER_DIRECTOR_NAME = #{record.orderDirectorName,jdbcType=VARCHAR},
      CP_MAIN = #{record.cpMain,jdbcType=TINYINT},
      PAY_UNIT = #{record.payUnit,jdbcType=DECIMAL},
      O_COUNT = #{record.oCount,jdbcType=INTEGER},
      O_AMOUNT = #{record.oAmount,jdbcType=DECIMAL},
      CHANNEL_ID = #{record.channelId,jdbcType=INTEGER},
      CHANNEL_NAME = #{record.channelName,jdbcType=VARCHAR},
      OUTER_UNIT = #{record.outerUnit,jdbcType=DECIMAL},
      C_COUNT = #{record.cCount,jdbcType=INTEGER},
      C_AMOUNT = #{record.cAmount,jdbcType=DECIMAL},
      CHANNEL_DIRECTOR_NAME = #{record.channelDirectorName,jdbcType=VARCHAR},
      ENTRY_DAY_STATUS = #{record.entryDayStatus,jdbcType=TINYINT},
      CREATE_TIME = #{record.createTime,jdbcType=TIMESTAMP},
      MODIFY_TIME = #{record.modifyTime,jdbcType=TIMESTAMP},
      OC_DAY_STATUS = #{record.ocDayStatus,jdbcType=TINYINT},
      ENTRY_TIME = #{record.entryTime,jdbcType=DATE},
      CHANNEL_MONTH_STATUS = #{record.channelMonthStatus,jdbcType=TINYINT},
      AVG_MEDIA_REBATE = #{record.avgMediaRebate,jdbcType=DECIMAL},
      AVG_OTHER_EXPENSE = #{record.avgOtherExpense,jdbcType=DECIMAL},
      AVG_CHANNEL_CUT = #{record.avgChannelCut,jdbcType=DECIMAL},
      ORDER_MONTH_STATUS = #{record.orderMonthStatus,jdbcType=TINYINT}
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.imopan.adv.platform.entity.fos.FosOcDay">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update fos_oc_day
    <set>
      <if test="channelOrderId != null">
        CHANNEL_ORDER_ID = #{channelOrderId,jdbcType=INTEGER},
      </if>
      <if test="orderId != null">
        ORDER_ID = #{orderId,jdbcType=INTEGER},
      </if>
      <if test="orderName != null">
        ORDER_NAME = #{orderName,jdbcType=VARCHAR},
      </if>
      <if test="productName != null">
        PRODUCT_NAME = #{productName,jdbcType=VARCHAR},
      </if>
      <if test="cooperateName != null">
        COOPERATE_NAME = #{cooperateName,jdbcType=VARCHAR},
      </if>
      <if test="orderDirectorName != null">
        ORDER_DIRECTOR_NAME = #{orderDirectorName,jdbcType=VARCHAR},
      </if>
      <if test="cpMain != null">
        CP_MAIN = #{cpMain,jdbcType=TINYINT},
      </if>
      <if test="payUnit != null">
        PAY_UNIT = #{payUnit,jdbcType=DECIMAL},
      </if>
      <if test="oCount != null">
        O_COUNT = #{oCount,jdbcType=INTEGER},
      </if>
      <if test="oAmount != null">
        O_AMOUNT = #{oAmount,jdbcType=DECIMAL},
      </if>
      <if test="channelId != null">
        CHANNEL_ID = #{channelId,jdbcType=INTEGER},
      </if>
      <if test="channelName != null">
        CHANNEL_NAME = #{channelName,jdbcType=VARCHAR},
      </if>
      <if test="outerUnit != null">
        OUTER_UNIT = #{outerUnit,jdbcType=DECIMAL},
      </if>
      <if test="cCount != null">
        C_COUNT = #{cCount,jdbcType=INTEGER},
      </if>
      <if test="cAmount != null">
        C_AMOUNT = #{cAmount,jdbcType=DECIMAL},
      </if>
      <if test="channelDirectorName != null">
        CHANNEL_DIRECTOR_NAME = #{channelDirectorName,jdbcType=VARCHAR},
      </if>
      <if test="entryDayStatus != null">
        ENTRY_DAY_STATUS = #{entryDayStatus,jdbcType=TINYINT},
      </if>
      <if test="createTime != null">
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="modifyTime != null">
        MODIFY_TIME = #{modifyTime,jdbcType=TIMESTAMP},
      </if>
      <if test="ocDayStatus != null">
        OC_DAY_STATUS = #{ocDayStatus,jdbcType=TINYINT},
      </if>
      <if test="entryTime != null">
        ENTRY_TIME = #{entryTime,jdbcType=DATE},
      </if>
      <if test="channelMonthStatus != null">
        CHANNEL_MONTH_STATUS = #{channelMonthStatus,jdbcType=TINYINT},
      </if>
      <if test="avgMediaRebate != null">
        AVG_MEDIA_REBATE = #{avgMediaRebate,jdbcType=DECIMAL},
      </if>
      <if test="avgOtherExpense != null">
        AVG_OTHER_EXPENSE = #{avgOtherExpense,jdbcType=DECIMAL},
      </if>
      <if test="avgChannelCut != null">
        AVG_CHANNEL_CUT = #{avgChannelCut,jdbcType=DECIMAL},
      </if>
      <if test="orderMonthStatus != null">
        ORDER_MONTH_STATUS = #{orderMonthStatus,jdbcType=TINYINT},
      </if>
    </set>
    where ID = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.imopan.adv.platform.entity.fos.FosOcDay">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update fos_oc_day
    set CHANNEL_ORDER_ID = #{channelOrderId,jdbcType=INTEGER},
      ORDER_ID = #{orderId,jdbcType=INTEGER},
      ORDER_NAME = #{orderName,jdbcType=VARCHAR},
      PRODUCT_NAME = #{productName,jdbcType=VARCHAR},
      COOPERATE_NAME = #{cooperateName,jdbcType=VARCHAR},
      ORDER_DIRECTOR_NAME = #{orderDirectorName,jdbcType=VARCHAR},
      CP_MAIN = #{cpMain,jdbcType=TINYINT},
      PAY_UNIT = #{payUnit,jdbcType=DECIMAL},
      O_COUNT = #{oCount,jdbcType=INTEGER},
      O_AMOUNT = #{oAmount,jdbcType=DECIMAL},
      CHANNEL_ID = #{channelId,jdbcType=INTEGER},
      CHANNEL_NAME = #{channelName,jdbcType=VARCHAR},
      OUTER_UNIT = #{outerUnit,jdbcType=DECIMAL},
      C_COUNT = #{cCount,jdbcType=INTEGER},
      C_AMOUNT = #{cAmount,jdbcType=DECIMAL},
      CHANNEL_DIRECTOR_NAME = #{channelDirectorName,jdbcType=VARCHAR},
      ENTRY_DAY_STATUS = #{entryDayStatus,jdbcType=TINYINT},
      CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      MODIFY_TIME = #{modifyTime,jdbcType=TIMESTAMP},
      OC_DAY_STATUS = #{ocDayStatus,jdbcType=TINYINT},
      ENTRY_TIME = #{entryTime,jdbcType=DATE},
      CHANNEL_MONTH_STATUS = #{channelMonthStatus,jdbcType=TINYINT},
      AVG_MEDIA_REBATE = #{avgMediaRebate,jdbcType=DECIMAL},
      AVG_OTHER_EXPENSE = #{avgOtherExpense,jdbcType=DECIMAL},
      AVG_CHANNEL_CUT = #{avgChannelCut,jdbcType=DECIMAL},
      ORDER_MONTH_STATUS = #{orderMonthStatus,jdbcType=TINYINT}
    where ID = #{id,jdbcType=INTEGER}
  </update>

	<select id="saveBatch" parameterType="java.util.List">
		insert ignore into fos_oc_day (ID, CHANNEL_ORDER_ID, ORDER_ID,
		ORDER_NAME, PRODUCT_NAME, ORDER_DIRECTOR_NAME,
		COOPERATE_NAME, CP_MAIN, PAY_UNIT,
		O_COUNT, O_AMOUNT, CHANNEL_ID,
		CHANNEL_NAME, OUTER_UNIT, C_COUNT,
		C_AMOUNT, CHANNEL_DIRECTOR_NAME, ENTRY_DAY_STATUS,
		CREATE_TIME, MODIFY_TIME, OC_DAY_STATUS,
		ENTRY_TIME)
		VALUES
		<foreach collection="list" index="index" item="itm" separator=",">
			(#{itm.id,jdbcType=INTEGER}, #{itm.channelOrderId,jdbcType=INTEGER},
			#{itm.orderId,jdbcType=INTEGER},
			#{itm.orderName,jdbcType=VARCHAR}, #{itm.productName,jdbcType=VARCHAR},
			#{itm.orderDirectorName,jdbcType=VARCHAR},#{itm.cooperateName,jdbcType=VARCHAR},
			#{itm.cpMain,jdbcType=TINYINT},
			#{itm.payUnit,jdbcType=DECIMAL}, #{itm.oCount,jdbcType=INTEGER}, #{itm.oAmount,jdbcType=DECIMAL},
			#{itm.channelId,jdbcType=INTEGER},
			#{itm.channelName,jdbcType=VARCHAR},
			#{itm.outerUnit,jdbcType=DECIMAL},
			#{itm.cCount,jdbcType=INTEGER}, #{itm.cAmount,jdbcType=DECIMAL},
			#{itm.channelDirectorName,jdbcType=VARCHAR},
			#{itm.entryDayStatus,jdbcType=TINYINT},
			#{itm.createTime,jdbcType=TIMESTAMP},
			#{itm.modifyTime,jdbcType=TIMESTAMP},
			#{itm.ocDayStatus,jdbcType=TINYINT}, #{itm.entryTime,jdbcType=DATE})
		</foreach>
	</select>


	<update id="updateBatch" parameterType="java.util.List">

		<foreach close="" collection="list" index="index" item="item" open="" separator=";">
			update fos_oc_day
			<set>
				<if test="item.channelOrderId != null">
					CHANNEL_ORDER_ID = #{item.channelOrderId,jdbcType=INTEGER},
				</if>
				<if test="item.orderId != null">
					ORDER_ID = #{item.orderId,jdbcType=INTEGER},
				</if>
				<if test="item.orderName != null">
					ORDER_NAME = #{item.orderName,jdbcType=VARCHAR},
				</if>
				<if test="item.productName != null">
					PRODUCT_NAME = #{item.productName,jdbcType=VARCHAR},
				</if>
				<if test="item.orderDirectorName != null">
					ORDER_DIRECTOR_NAME = #{item.orderDirectorName,jdbcType=VARCHAR},
				</if>
				<if test="item.payUnit != null">
					PAY_UNIT = #{item.payUnit,jdbcType=DECIMAL},
				</if>
				<if test="item.oCount != null">
					O_COUNT = #{item.oCount,jdbcType=INTEGER},
				</if>
				<if test="item.oAmount != null">
					O_AMOUNT = #{item.oAmount,jdbcType=DECIMAL},
				</if>
				<if test="item.channelId != null">
					CHANNEL_ID = #{item.channelId,jdbcType=INTEGER},
				</if>
				<if test="item.channelName != null">
					CHANNEL_NAME = #{item.channelName,jdbcType=VARCHAR},
				</if>
				<if test="item.outerUnit != null">
					OUTER_UNIT = #{item.outerUnit,jdbcType=DECIMAL},
				</if>
				<if test="item.cCount != null">
					C_COUNT = #{item.cCount,jdbcType=INTEGER},
				</if>
				<if test="item.cAmount != null">
					C_AMOUNT = #{item.cAmount,jdbcType=DECIMAL},
				</if>
				<if test="item.channelDirectorName != null">
					CHANNEL_DIRECTOR_NAME = #{item.channelDirectorName,jdbcType=VARCHAR},
				</if>
				<if test="item.entryDayStatus != null">
					ENTRY_DAY_STATUS = #{item.entryDayStatus,jdbcType=TINYINT},
				</if>
				<if test="item.createTime != null">
					CREATE_TIME = #{item.createTime,jdbcType=TIMESTAMP},
				</if>
				<if test="item.modifyTime != null">
					MODIFY_TIME = #{item.modifyTime,jdbcType=TIMESTAMP},
				</if>
				<if test="item.ocDayStatus != null">
					OC_DAY_STATUS = #{item.ocDayStatus,jdbcType=TINYINT},
				</if>
				<if test="item.entryTime != null">
					ENTRY_TIME = #{item.entryTime,jdbcType=DATE},
				</if>
			</set>
			where ID = #{item.id,jdbcType=INTEGER}
		</foreach>

	</update>


	<resultMap id="FindByExampleMap" type="com.imopan.adv.platform.entity.fos.FosDailyBill">

		<id column="ID" jdbcType="INTEGER" property="id" />
		<result column="CHANNEL_ORDER_ID" jdbcType="INTEGER" property="channelOrderId" />
		<result column="ORDER_ID" jdbcType="INTEGER" property="orderId" />
		<result column="ORDER_NAME" jdbcType="VARCHAR" property="orderName" />
		<result column="PRODUCT_NAME" jdbcType="VARCHAR" property="productName" />
		<result column="ORDER_DIRECTOR_NAME" jdbcType="VARCHAR" property="orderDirectorName" />
		<result column="COOPERATE_NAME" jdbcType="VARCHAR" property="cooperateName" />
		<result column="CP_MAIN" jdbcType="TINYINT" property="cpMain" />
		<result column="PAY_UNIT" jdbcType="DECIMAL" property="payUnit" />
		<result column="O_COUNT" jdbcType="INTEGER" property="oCount" />
		<result column="O_AMOUNT" jdbcType="DECIMAL" property="oAmount" />
		<result column="CHANNEL_ID" jdbcType="INTEGER" property="channelId" />
		<result column="CHANNEL_NAME" jdbcType="VARCHAR" property="channelName" />
		<result column="OUTER_UNIT" jdbcType="DECIMAL" property="outerUnit" />
		<result column="C_COUNT" jdbcType="INTEGER" property="cCount" />
		<result column="C_AMOUNT" jdbcType="DECIMAL" property="cAmount" />
		<result column="CHANNEL_DIRECTOR_NAME" jdbcType="VARCHAR" property="channelDirectorName" />
		<result column="ENTRY_DAY_STATUS" jdbcType="TINYINT" property="entryDayStatus" />
		<result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
		<result column="MODIFY_TIME" jdbcType="TIMESTAMP" property="modifyTime" />
		<result column="OC_DAY_STATUS" jdbcType="TINYINT" property="ocDayStatus" />
		<result column="ENTRY_TIME" jdbcType="DATE" property="entryTime" />
		<result column="CHANNEL_MONTH_STATUS" jdbcType="TINYINT" property="channelMonthStatus" />
		<result column="AVG_MEDIA_REBATE" jdbcType="DECIMAL" property="avgMediaRebate" />
		<result column="AVG_OTHER_EXPENSE" jdbcType="DECIMAL" property="avgOtherExpense" />
		<result column="AVG_CHANNEL_CUT" jdbcType="DECIMAL" property="avgChannelCut" />
		<result column="ORDER_MONTH_STATUS" jdbcType="TINYINT" property="orderMonthStatus" />
		<result column="PROFIT" jdbcType="DECIMAL" property="profit" />
		<result column="PROFIT_MARGIN" jdbcType="DECIMAL" property="profitMargin" />
		<result column="ORDER_DEPARTMENT" jdbcType="TINYINT" property="orderDepartment" />
	</resultMap>
<!-- 	<select id="getDayBillList" parameterType="map" resultMap="FindByExampleMap"> -->
<!-- 		SELECT -->
<!-- 		CHANNEL_ORDER_ID, -->
<!-- 		ORDER_ID, -->
<!-- 		ORDER_NAME, -->
<!-- 		PRODUCT_NAME, -->
<!-- 		ORDER_DIRECTOR_NAME, -->
<!-- 		COOPERATE_NAME, -->
<!-- 		CP_MAIN, -->
<!-- 		PAY_UNIT, -->
<!-- 		SUM(O_COUNT) O_COUNT, -->
<!-- 		SUM(O_AMOUNT) O_AMOUNT, -->
<!-- 		CHANNEL_ID, -->
<!-- 		CHANNEL_NAME, -->
<!-- 		CHANNEL_DIRECTOR_NAME, -->
<!-- 		OUTER_UNIT, -->
<!-- 		SUM(C_COUNT) C_COUNT, -->
<!-- 		SUM(C_AMOUNT) C_AMOUNT, -->
<!-- 		SUM(O_AMOUNT)-SUM(C_AMOUNT) PROFIT, -->
<!-- 		(SUM(O_AMOUNT)-SUM(C_AMOUNT))/SUM(O_AMOUNT) PROFIT_MARGIN, -->
<!-- 		ORDER_MONTH_STATUS, -->
<!-- 		CHANNEL_MONTH_STATUS, -->
<!-- 		ENTRY_TIME -->
<!-- 		ENTRY_TIME -->
<!-- 		FROM -->
<!-- 		FOS_OC_DAY -->
<!-- 		WHERE -->
<!-- 		1 = 1 -->
<!-- 		AND OC_DAY_STATUS = 0 -->
<!-- 		AND ENTRY_DAY_STATUS=1 -->
<!-- 		<if test="beginTime != null"> -->
<!-- 			AND ENTRY_TIME&gt;= #{beginTime} -->
<!-- 		</if> -->
<!-- 		<if test="endTime != null"> -->
<!-- 			AND ENTRY_TIME&lt;= #{endTime} -->
<!-- 		</if> -->
<!-- 		<if test="orderName != null"> -->
<!-- 			AND ORDER_NAME like #{orderName} -->
<!-- 		</if> -->
<!-- 		<if test="orderId != null"> -->
<!-- 			AND ORDER_ID = #{orderId} -->
<!-- 		</if> -->
<!-- 		<if test="channelId != null"> -->
<!-- 			AND CHANNEL_ID = #{channelId} -->
<!-- 		</if> -->
<!-- 		<if test="directorNI != null"> -->
<!-- 			AND ORDER_DIRECTOR_NAME = #{directorNI} -->
<!-- 		</if> -->
<!-- 		<if test="channelName != null"> -->
<!-- 			AND CHANNEL_NAME like #{channelName} -->
<!-- 		</if> -->
<!-- 		<if test="directorName != null"> -->
<!-- 			AND ORDER_DIRECTOR_NAME like #{directorName} -->
<!-- 		</if> -->
<!-- 		<if test="orderMonthStatus != null"> -->
<!-- 			AND ORDER_MONTH_STATUS = #{orderMonthStatus} -->
<!-- 		</if> -->
<!-- 		<if test="channelMonthStatus != null"> -->
<!-- 			AND CHANNEL_MONTH_STATUS = #{channelMonthStatus} -->
<!-- 		</if> -->
<!-- 		<if test="groupByName != null"> -->
<!-- 			GROUP BY -->
<!-- 			${groupByName} -->
<!-- 		</if> -->
<!-- 		<if test="orderByName != null"> -->
<!-- 			ORDER BY -->
<!-- 			${orderByName} -->
<!-- 		</if> -->

<!-- 		<if test="LimitStart != null and LimitStart&gt;=0"> -->
<!-- 			LIMIT #{LimitStart} , #{LimitEnd} -->
<!-- 		</if> -->
<!-- 	</select> -->
	<select id="getDayBillList" parameterType="map" resultMap="FindByExampleMap">
		SELECT
		ocold.CHANNEL_ORDER_ID,
		ocold.ORDER_ID,
		ocold.ORDER_NAME,
		ocold.PRODUCT_NAME,
		ocold.ORDER_DIRECTOR_NAME,
		ocold.COOPERATE_NAME,
		ocold.CP_MAIN,
		ocold.PAY_UNIT,
		SUM(ocold.O_COUNT) O_COUNT,
		SUM(ocold.O_AMOUNT) O_AMOUNT,
		ocold.CHANNEL_ID,
		ocold.CHANNEL_NAME,
		ocold.CHANNEL_DIRECTOR_NAME,
		ocold.OUTER_UNIT,
		SUM(ocold.C_COUNT) C_COUNT,
		SUM(ocold.C_AMOUNT) C_AMOUNT,
		SUM(ocold.O_AMOUNT)-SUM(ocold.C_AMOUNT) PROFIT,
		(SUM(ocold.O_AMOUNT)-SUM(ocold.C_AMOUNT))/SUM(ocold.O_AMOUNT) PROFIT_MARGIN,
		ocold.ORDER_MONTH_STATUS,
		ocold.CHANNEL_MONTH_STATUS,
		ocold.ENTRY_TIME ,
		ocold.ORDER_DEPARTMENT
		FROM (SELECT oc.CHANNEL_ORDER_ID,
		oc.ORDER_ID,
		oc.ORDER_NAME,
		oc.PRODUCT_NAME,
		oc.ORDER_DIRECTOR_NAME,
		oc.COOPERATE_NAME,
		oc.CP_MAIN,
		oc.PAY_UNIT,
		oc.CHANNEL_ID,
		oc.CHANNEL_NAME,
		oc.CHANNEL_DIRECTOR_NAME,
		oc.OUTER_UNIT,
		oc.ORDER_MONTH_STATUS,
		oc.CHANNEL_MONTH_STATUS,
		oc.ENTRY_TIME, 
	(case cp.FINANCIAL_SUBMIT_CP_STATUS WHEN 3 then cp.FINANCIAL_SUBMIT_OAMOUNT ELSE oc.O_AMOUNT END) as O_AMOUNT, 
	(case cp.FINANCIAL_SUBMIT_CP_STATUS WHEN 3 then cp.FINANCIAL_SUBMIT_OCOUNT ELSE oc.O_COUNT END) as O_COUNT, 

	(case chan.FINANCIAL_SUBMIT_CHANNEL_STATUS WHEN 3 then chan.FINANCIAL_SUBMIT_CAMOUNT ELSE oc.C_AMOUNT END) as C_AMOUNT, 
	(case chan.FINANCIAL_SUBMIT_CHANNEL_STATUS WHEN 3 then chan.FINANCIAL_SUBMIT_CCOUNT ELSE oc.C_COUNT END) as C_COUNT ,
	fosor.ORDER_DEPARTMENT as ORDER_DEPARTMENT
 	FROM fos_oc_day oc LEFT JOIN fos_audit_cp_day cp ON oc.ID = cp.OC_DAY_ID 
	LEFT JOIN fos_audit_channel_day chan ON chan.OC_DAY_ID = oc.ID 
	LEFT JOIN fos_order fosor ON oc.ORDER_ID = fosor.ORDER_ID 
 	LEFT JOIN channel_info_v2 cinfo ON cinfo.ID = oc.CHANNEL_ID 
	where 1=1
	 
		<!-- 数据级控制  begin -->
		<if test="businessNames != null">
			AND  oc.ORDER_DIRECTOR_NAME in  ${businessNames}
		</if>
		<if test="channelNames != null">
			AND  oc.CHANNEL_DIRECTOR_NAME in  ${channelNames}
		</if>
		<if test="teamId != null">
			AND  fosor.ORDER_DEPARTMENT =  #{teamId} 
		</if>
		<!-- 数据级控制  end -->
		
		<if test="orderDepartment != null">
			AND  fosor.ORDER_DEPARTMENT =  #{orderDepartment}
		</if>
		
		<if test="beginTime != null">
			AND oc.ENTRY_TIME&gt;= #{beginTime}
		</if>
		<if test="endTime != null">
			AND oc.ENTRY_TIME&lt;= #{endTime}
		</if>
		<if test="orderName != null">
			AND oc.ORDER_NAME like #{orderName}
		</if>
		<if test="orderId != null">
			AND oc.ORDER_ID = #{orderId}
		</if>
		<if test="channelId != null">
			AND oc.CHANNEL_ID = #{channelId}
		</if>
		<if test="directorNI != null">
			AND oc.ORDER_DIRECTOR_NAME = #{directorNI}
		</if>
		<if test="channelName != null">
			AND oc.CHANNEL_NAME like #{channelName}
		</if>
		<if test="directorName != null">
			AND oc.ORDER_DIRECTOR_NAME like #{directorName}
		</if>
		<if test="orderMonthStatus != null">
			AND oc.ORDER_MONTH_STATUS = #{orderMonthStatus}
		</if>
		<if test="channelMonthStatus != null">
			AND oc.CHANNEL_MONTH_STATUS = #{channelMonthStatus}
		</if>
		<if test="cooperateName != null">
			AND oc.COOPERATE_NAME like #{cooperateName}
		</if>
		
		
		AND oc.O_AMOUNT is NOT NULL AND oc.C_COUNT is NOT NULL AND oc.C_AMOUNT is NOT NULL AND oc.C_COUNT is NOT NULL) ocold 

		<if test="groupByName != null">
			GROUP BY
			ocold.${groupByName}
		</if>
		<if test="orderByName != null">
			ORDER BY
			ocold.${orderByName}
		</if> 
		<if test="LimitStart != null and LimitStart&gt;=0">
			LIMIT #{LimitStart} , #{LimitEnd}
		</if>
	</select>
	<select id="countGetDayBillList" parameterType="map" resultType="java.lang.Integer">
		SELECT COUNT(*)
		FROM
		(
		SELECT
		ocold.CHANNEL_ORDER_ID,
		ocold.ORDER_ID,
		ocold.ORDER_NAME,
		ocold.PRODUCT_NAME,
		ocold.ORDER_DIRECTOR_NAME,
		ocold.COOPERATE_NAME,
		ocold.CP_MAIN,
		ocold.PAY_UNIT,
		SUM(ocold.O_COUNT) O_COUNT,
		SUM(ocold.O_AMOUNT) O_AMOUNT,
		ocold.CHANNEL_ID,
		ocold.CHANNEL_NAME,
		ocold.CHANNEL_DIRECTOR_NAME,
		ocold.OUTER_UNIT,
		SUM(ocold.C_COUNT) C_COUNT,
		SUM(ocold.C_AMOUNT) C_AMOUNT,
		SUM(ocold.O_AMOUNT)-SUM(ocold.C_AMOUNT) PROFIT,
		(SUM(ocold.O_AMOUNT)-SUM(ocold.C_AMOUNT))/SUM(ocold.O_AMOUNT) PROFIT_MARGIN,
		ocold.ORDER_MONTH_STATUS,
		ocold.CHANNEL_MONTH_STATUS,
		ocold.ENTRY_TIME ,
		ocold.ORDER_DEPARTMENT
		FROM (SELECT oc.CHANNEL_ORDER_ID,
		oc.ORDER_ID,
		oc.ORDER_NAME,
		oc.PRODUCT_NAME,
		oc.ORDER_DIRECTOR_NAME,
		oc.COOPERATE_NAME,
		oc.CP_MAIN,
		oc.PAY_UNIT,
		oc.CHANNEL_ID,
		oc.CHANNEL_NAME,
		oc.CHANNEL_DIRECTOR_NAME,
		oc.OUTER_UNIT,
		oc.ORDER_MONTH_STATUS,
		oc.CHANNEL_MONTH_STATUS,
		oc.ENTRY_TIME, 
	(case cp.FINANCIAL_SUBMIT_CP_STATUS WHEN 3 then cp.FINANCIAL_SUBMIT_OAMOUNT ELSE oc.O_AMOUNT END) as O_AMOUNT, 
	(case cp.FINANCIAL_SUBMIT_CP_STATUS WHEN 3 then cp.FINANCIAL_SUBMIT_OCOUNT ELSE oc.O_COUNT END) as O_COUNT, 

	(case chan.FINANCIAL_SUBMIT_CHANNEL_STATUS WHEN 3 then chan.FINANCIAL_SUBMIT_CAMOUNT ELSE oc.C_AMOUNT END) as C_AMOUNT, 
	(case chan.FINANCIAL_SUBMIT_CHANNEL_STATUS WHEN 3 then chan.FINANCIAL_SUBMIT_CCOUNT ELSE oc.C_COUNT END) as C_COUNT ,
	fosor.ORDER_DEPARTMENT as ORDER_DEPARTMENT
 	FROM fos_oc_day oc LEFT JOIN fos_audit_cp_day cp ON oc.ID = cp.OC_DAY_ID 
	LEFT JOIN fos_audit_channel_day chan ON chan.OC_DAY_ID = oc.ID 
	LEFT JOIN fos_order fosor ON oc.ORDER_ID = fosor.ORDER_ID 
 	LEFT JOIN channel_info_v2 cinfo ON cinfo.ID = oc.CHANNEL_ID 
	where 1=1
	 
		<!-- 数据级控制  begin -->
		<if test="businessNames != null">
			AND  oc.ORDER_DIRECTOR_NAME in  ${businessNames}
		</if>
		<if test="channelNames != null">
			AND  oc.CHANNEL_DIRECTOR_NAME in  ${channelNames}
		</if>
		<if test="teamId != null">
			AND  fosor.ORDER_DEPARTMENT =  #{teamId} 
		</if>
		<!-- 数据级控制  end -->
		
		<if test="orderDepartment != null">
			AND  fosor.ORDER_DEPARTMENT =  #{orderDepartment}
		</if>
		
		<if test="beginTime != null">
			AND oc.ENTRY_TIME&gt;= #{beginTime}
		</if>
		<if test="endTime != null">
			AND oc.ENTRY_TIME&lt;= #{endTime}
		</if>
		<if test="orderName != null">
			AND oc.ORDER_NAME like #{orderName}
		</if>
		<if test="orderId != null">
			AND oc.ORDER_ID = #{orderId}
		</if>
		<if test="channelId != null">
			AND oc.CHANNEL_ID = #{channelId}
		</if>
		<if test="directorNI != null">
			AND oc.ORDER_DIRECTOR_NAME = #{directorNI}
		</if>
		<if test="channelName != null">
			AND oc.CHANNEL_NAME like #{channelName}
		</if>
		<if test="directorName != null">
			AND oc.ORDER_DIRECTOR_NAME like #{directorName}
		</if>
		<if test="orderMonthStatus != null">
			AND oc.ORDER_MONTH_STATUS = #{orderMonthStatus}
		</if>
		<if test="channelMonthStatus != null">
			AND oc.CHANNEL_MONTH_STATUS = #{channelMonthStatus}
		</if>
		<if test="cooperateName != null">
			AND oc.COOPERATE_NAME like #{cooperateName}
		</if>
		
		
		AND oc.O_AMOUNT is NOT NULL AND oc.C_COUNT is NOT NULL AND oc.C_AMOUNT is NOT NULL AND oc.C_COUNT is NOT NULL) ocold 

		<if test="groupByName != null">
			GROUP BY
			ocold.${groupByName}
		</if>
		<if test="orderByName != null">
			ORDER BY
			ocold.${orderByName}
		</if> 
		) W
	</select>
	
	
	
	<select id="getChartCooperateName" parameterType="map" resultType="java.util.HashMap">
		SELECT
			A.COOPERATE_NAME,
			A.O_AMOUNT O_AMOUNT,
			B.O_AMOUNT O_AMOUNT_0,
			C.O_AMOUNT O_AMOUNT_1
		FROM
			(
				SELECT
					COOPERATE_NAME,
					SUM(O_AMOUNT) O_AMOUNT
				FROM
					FOS_OC_DAY
				WHERE
					1 = 1
				<if test="beginTime != null and endTime != null">
					and ENTRY_TIME &gt;= #{beginTime} and ENTRY_TIME &lt;= #{endTime}
				</if>
				GROUP BY
					COOPERATE_NAME
			) A
		LEFT JOIN (
			SELECT
				COOPERATE_NAME,
				SUM(O_AMOUNT) O_AMOUNT
			FROM
				FOS_OC_DAY
			WHERE
				1 = 1
				<if test="beginTime != null and endTime != null">
					and ENTRY_TIME &gt;= #{beginTime} and ENTRY_TIME &lt;= #{endTime}
				</if>
			AND ORDER_MONTH_STATUS = '0'
			GROUP BY
				COOPERATE_NAME
		) B ON A.COOPERATE_NAME = B.COOPERATE_NAME
		LEFT JOIN (
			SELECT
				COOPERATE_NAME,
				SUM(O_AMOUNT) O_AMOUNT
			FROM
				FOS_OC_DAY
			WHERE
				1 = 1
				<if test="beginTime != null and endTime != null">
					and ENTRY_TIME &gt;= #{beginTime} and ENTRY_TIME &lt;= #{endTime}
				</if>
			AND ORDER_MONTH_STATUS = '1'
			GROUP BY
				COOPERATE_NAME
		) C ON B.COOPERATE_NAME = C.COOPERATE_NAME
		ORDER BY A.O_AMOUNT  DESC,B.O_AMOUNT  DESC,C.O_AMOUNT  DESC
	</select>
	
	
	<select id="getChartChannel" parameterType="map" resultType="java.util.HashMap">
		SELECT
			A.CHANNEL_ID,
			A.CHANNEL_NAME,
			A.O_AMOUNT O_AMOUNT,
			B.O_AMOUNT O_AMOUNT_0,
			C.O_AMOUNT O_AMOUNT_1
		FROM
			(
				SELECT
					CHANNEL_ID,
					CHANNEL_NAME,
					SUM(O_AMOUNT) O_AMOUNT
				FROM
					FOS_OC_DAY
				WHERE
					1 = 1
					<if test="beginTime != null and endTime != null">
					and ENTRY_TIME &gt;= #{beginTime} and ENTRY_TIME &lt;= #{endTime}
				</if>
				GROUP BY
					CHANNEL_ID
			) A
		LEFT JOIN (
			SELECT
				CHANNEL_ID,
				CHANNEL_NAME,
				SUM(O_AMOUNT) O_AMOUNT
			FROM
				FOS_OC_DAY
			WHERE
				1 = 1
				<if test="beginTime != null and endTime != null">
					and ENTRY_TIME &gt;= #{beginTime} and ENTRY_TIME &lt;= #{endTime}
				</if>
			AND ORDER_MONTH_STATUS = '0'
			GROUP BY
				CHANNEL_ID
		) B ON A.CHANNEL_ID = B.CHANNEL_ID
		LEFT JOIN (
			SELECT
				CHANNEL_ID,
				CHANNEL_NAME,
				SUM(O_AMOUNT) O_AMOUNT
			FROM
				FOS_OC_DAY
			WHERE
				1 = 1
				<if test="beginTime != null and endTime != null">
					and ENTRY_TIME &gt;= #{beginTime} and ENTRY_TIME &lt;= #{endTime}
				</if>
			AND ORDER_MONTH_STATUS = '1'
			GROUP BY
				CHANNEL_ID
		) C ON B.CHANNEL_ID = C.CHANNEL_ID
		ORDER BY A.O_AMOUNT  DESC,B.O_AMOUNT  DESC,C.O_AMOUNT  DESC
	</select>
	
	
	<select id="getChartOrderDirectorName" parameterType="map" resultType="java.util.HashMap">
		SELECT
			A.ORDER_DIRECTOR_NAME,
			A.O_AMOUNT O_AMOUNT,
			B.O_AMOUNT O_AMOUNT_0,
			C.O_AMOUNT O_AMOUNT_1
		FROM
			(
				SELECT
					ORDER_DIRECTOR_NAME,
					SUM(O_AMOUNT) O_AMOUNT
				FROM
					FOS_OC_DAY
				WHERE
					1 = 1
					<if test="beginTime != null and endTime != null">
					and ENTRY_TIME &gt;= #{beginTime} and ENTRY_TIME &lt;= #{endTime}
				</if>
				GROUP BY
					ORDER_DIRECTOR_NAME
			) A
		LEFT JOIN (
			SELECT
				ORDER_DIRECTOR_NAME,
				SUM(O_AMOUNT) O_AMOUNT
			FROM
				FOS_OC_DAY
			WHERE
				1 = 1
				<if test="beginTime != null and endTime != null">
					and ENTRY_TIME &gt;= #{beginTime} and ENTRY_TIME &lt;= #{endTime}
				</if>
			AND ORDER_MONTH_STATUS = '0'
			GROUP BY
				ORDER_DIRECTOR_NAME
		) B ON A.ORDER_DIRECTOR_NAME = B.ORDER_DIRECTOR_NAME
		LEFT JOIN (
			SELECT
				ORDER_DIRECTOR_NAME,
				SUM(O_AMOUNT) O_AMOUNT
			FROM
				FOS_OC_DAY
			WHERE
				1 = 1
				<if test="beginTime != null and endTime != null">
					and ENTRY_TIME &gt;= #{beginTime} and ENTRY_TIME &lt;= #{endTime}
				</if>
			AND ORDER_MONTH_STATUS = '1'
			GROUP BY
				ORDER_DIRECTOR_NAME
		) C ON B.ORDER_DIRECTOR_NAME = C.ORDER_DIRECTOR_NAME
		ORDER BY A.O_AMOUNT  DESC,B.O_AMOUNT  DESC,C.O_AMOUNT  DESC
	</select>
	
	
	<select id="getChartChannel_Line" parameterType="map" resultType="java.util.HashMap">
		SELECT
			CHANNEL_NAME FLAG_NAME,
			SUM(O_AMOUNT) O_AMOUNT,
			ENTRY_TIME
		FROM
			FOS_OC_DAY
		WHERE 1=1
			<if test="name != null">
				and CHANNEL_NAME = #{name}
			</if>
			<if test="beginTime != null and endTime != null">
				and ENTRY_TIME &gt;= #{beginTime} and ENTRY_TIME &lt;= #{endTime}
			</if>
		GROUP BY
			CHANNEL_ID,
			ENTRY_TIME
	</select>
	
	<select id="getChartCooperateName_Line" parameterType="map" resultType="java.util.HashMap">
		SELECT
			COOPERATE_NAME FLAG_NAME,
			SUM(O_AMOUNT) O_AMOUNT,
			ENTRY_TIME
		FROM
			FOS_OC_DAY
		WHERE 1=1
			<if test="name != null">
				and COOPERATE_NAME = #{name}
			</if>
			<if test="beginTime != null and endTime != null">
				and ENTRY_TIME &gt;= #{beginTime} and ENTRY_TIME &lt;= #{endTime}
			</if>
		GROUP BY
			COOPERATE_NAME,
			ENTRY_TIME
	</select>
	
	<select id="getChartOrderDirectorName_Line" parameterType="map" resultType="java.util.HashMap">
		SELECT
			ORDER_DIRECTOR_NAME FLAG_NAME,
			SUM(O_AMOUNT) O_AMOUNT,
			ENTRY_TIME
		FROM
			FOS_OC_DAY
		WHERE 1=1
			<if test="name != null">
				and ORDER_DIRECTOR_NAME = #{name}
			</if>
			<if test="beginTime != null and endTime != null">
				and ENTRY_TIME &gt;= #{beginTime} and ENTRY_TIME &lt;= #{endTime}
			</if>
		GROUP BY
			ORDER_DIRECTOR_NAME,
			ENTRY_TIME
	</select>
	
	<select id="getAllName" parameterType="map" resultType="java.util.HashMap">
		SELECT DISTINCT
			<if test="flag == 1 ">
				COOPERATE_NAME name
			</if>
			<if test="flag == 2 ">
				CHANNEL_NAME name
			</if>
			<if test="flag == 3 ">
				ORDER_DIRECTOR_NAME name
			</if>
		FROM
			FOS_OC_DAY
		WHERE
			1 = 1
	</select>
	
	<select id="getOcDayListSum" parameterType="map" resultMap="BaseResultMap">
		SELECT
			SUM(FOD.O_COUNT) O_COUNT,
			SUM(FOD.O_AMOUNT) O_AMOUNT,
			SUM(FOD.C_COUNT) C_COUNT,
			SUM(FOD.C_AMOUNT) C_AMOUNT
		FROM
			FOS_OC_DAY FOD
			LEFT JOIN FOS_ORDER FO ON FOD.ORDER_ID=FO.ORDER_ID
		WHERE
			1 = 1
			
		<!-- 数据级控制 -->
		<if test="businessNames != null">
			AND  fod.ORDER_DIRECTOR_NAME in  ${businessNames}
		</if>
		<if test="channelNames != null">
			AND  fod.CHANNEL_DIRECTOR_NAME in  ${channelNames}
		</if>
		<if test="teamId != null">
			AND  fo.ORDER_DEPARTMENT =  #{teamId}
		</if>
			
		<if test="beginTime != null">
			AND FOD.ENTRY_TIME&gt;= #{beginTime}
		</if>
		<if test="endTime != null">
			AND FOD.ENTRY_TIME&lt;= #{endTime}
		</if>
		<if test="orderName != null">
			AND FOD.ORDER_NAME like #{orderName}
		</if>
		<if test="channelName != null">
			AND FOD.CHANNEL_NAME like #{channelName}
		</if>
		<if test="orderDirectorName != null">
			AND FOD.ORDER_DIRECTOR_NAME like #{orderDirectorName}
		</if>
		<if test="ocDayStatus != null">
			AND  FOD.OC_DAY_STATUS =  #{ocDayStatus}
		</if>
		<if test="entryDayStatus != null">
			AND FOD.ENTRY_DAY_STATUS = #{entryDayStatus}
		</if>
			
	</select>
	
	
	
	<select id="getAuditOcDayList" parameterType="map" resultType="com.imopan.adv.platform.vo.fos.FosAuditOcDayVo">
		SELECT
			FOD.ID id,
				FOD.CHANNEL_ORDER_ID channelOrderId,
				FOD.ORDER_ID orderId,
				FOD.ORDER_NAME orderName,
				FOD.PRODUCT_NAME productName,
				FOD.ORDER_DIRECTOR_NAME orderDirectorName,
				FOD.COOPERATE_NAME cooperateName,
				FOD.CP_MAIN cpMain,
				FOD.PAY_UNIT payUnit,
				FOD.O_COUNT oCount,
				FOD.O_AMOUNT oAmount,
				FOD.CHANNEL_ID channelId,
				FOD.CHANNEL_NAME channelName,
				FOD.OUTER_UNIT outerUnit,
				FOD.C_COUNT cCount,
				FOD.C_AMOUNT cAmount,
				FOD.CHANNEL_DIRECTOR_NAME channelDirectorName,
				FOD.ENTRY_DAY_STATUS entryDayStatus,
				FOD.CREATE_TIME createTime,
				FOD.MODIFY_TIME modifyTime,
				FOD.OC_DAY_STATUS ocDayStatus,
				FOD.ENTRY_TIME entryTime,
				FOD.CHANNEL_MONTH_STATUS channelMonthStatus,
				FOD.AVG_MEDIA_REBATE avgMediaRebate,
				FOD.AVG_OTHER_EXPENSE avgOtherExpense,
				FOD.AVG_CHANNEL_CUT avgChannelCut,
				FOD.ORDER_MONTH_STATUS orderMonthStatus,
				FACPD.ID AUDITCPID,
				FACPD.OC_DAY_ID AUDITCPOCDAYID ,
				FACPD.ORDER_SUBMIT_CONFIRM orderSubmitConfirm,
				FACPD.CP_SUBMIT_PAYUNIT cpSubmitPayunit,
				FACPD.CP_SUBMIT_OCOUNT cpSubmitOcount,
				FACPD.CP_SUBMIT_OAMOUNT cpSubmitOamount,
				FACPD.FINANCIAL_SUBMIT_CP_STATUS financialSubmitCpStatus,
				FACPD.FINANCIAL_SUBMIT_PAYUNIT financialSubmitPayunit,
				FACPD.FINANCIAL_SUBMIT_OCOUNT financialSubmitOcount,
				FACPD.FINANCIAL_SUBMIT_OAMOUNT financialSubmitOamount,
				FACPD.FINANCIAL_SUBMIT_CP_DATE financialSubmitCpDate,
				FACPD.FINANCIAL_SUBMIT_CP_NOTTHROUGH_TIME financialSubmitCpNotthroughTime,
				FACPD.FINANCIAL_SUBMIT_CP_NOTTHROUGH_REASON financialSubmitCpNotthroughReason,
				FACPD.AVG_MONTH_OCOUNT avgMonthOcount,
				FACPD.AVG_MONTH_OAMOUNT avgMonthOamount,
				FACPD.AVG_CUT avgCut,
				FACPD.AVG_SALE_REBATE avgSaleRebate,
				FACPD.AVG_MONEY AUDITCPAVGMONEY,
				FACPD.AVG_RETURN_MONEY avgReturnMoney,
				FACPD.ORDER_MONTH_STATUS fosAuditCpDayOrderMonthStatus,
				FACPD.FINANCIAL_DRAWBILL_STATUS financialDrawbillStatus,
				FACPD.FINANCIAL_RECEIPT_STATUS financialReceiptStatus,
				FACHD.ID AUDITCHANNELID,
				FACHD.OC_DAY_ID ocDayId,
				FACHD.CHANNEL_SUBMIT_CONFIRM channelSubmitConfirm,
				FACHD.CHANNEL_SUBMIT_OUTERUNIT channelSubmitOuterunit,
				FACHD.CHANNEL_SUBMIT_CCOUNT channelSubmitCcount,
				FACHD.CHANNEL_SUBMIT_CAMOUNT channelSubmitCamount,
				FACHD.FINANCIAL_SUBMIT_CHANNEL_STATUS financialSubmitChannelStatus,
				FACHD.FINANCIAL_SUBMIT_OUTERUNIT financialSubmitOuterunit,
				FACHD.FINANCIAL_SUBMIT_CCOUNT financialSubmitCcount,
				FACHD.FINANCIAL_SUBMIT_CAMOUNT financialSubmitCamount,
				FACHD.FINANCIAL_SUBMIT_CHANNEL_DATE financialSubmitChannelDate,
				FACHD.FINANCIAL_SUBMIT_CHANNEL_NOTTHROUGH_TIME financialSubmitChannelNotthroughTime,
				FACHD.FINANCIAL_SUBMIT_CHANNEL_NOTTHROUGH_REASON financialSubmitChannelNotthroughReason,
				FACHD.AVG_MONTH_CCOUNT avgMonthCcount,
				FACHD.AVG_MONTH_CAMOUNT avgMonthCamount,
				FACHD.AVG_SUB_AMOUNT avgSubAmount,
				FACHD.AVG_MEDIA_REBATE AUDITCHANNELAVGMEDIAREBATE,
				FACHD.AVG_OTHER_EXPENSE AUDITCHANNELAVGOTHEREXPENSE,
				FACHD.AVG_CHANNEL_CUT AUDITCHANNELAVGCHANNELCUT,
				FACHD.AVG_MONEY avgMoney,
				FACHD.AVG_PAY_MONEY avgPayMoney,
				FACHD.CHANNEL_MONTH_STATUS fosAuditChannelDayMonthStatus,
				FACHD.FINANCIAL_RECEIVE_STATUS financialReceiveStatus,
				FACHD.FINANCIAL_PAY_STATUS financialPayStatus,
				fo.ORDER_DEPARTMENT orderDepartment
		FROM
			FOS_OC_DAY FOD
			LEFT JOIN FOS_AUDIT_CP_DAY FACPD ON FOD.ID = FACPD.OC_DAY_ID
			LEFT JOIN FOS_AUDIT_CHANNEL_DAY FACHD ON FOD.ID = FACHD.OC_DAY_ID
			LEFT JOIN FOS_ORDER FO ON FOD.ORDER_ID=FO.ORDER_ID
		WHERE 1=1	
		
	<!-- 数据级控制 -->
		<if test="businessNames != null">
			AND  fod.ORDER_DIRECTOR_NAME in  ${businessNames}
		</if>
		<if test="channelNames != null">
			AND  fod.CHANNEL_DIRECTOR_NAME in  ${channelNames}
		</if>
		<if test="teamId != null">
			AND  fo.ORDER_DEPARTMENT =  #{teamId}
		</if>

		<if test="orderDepartment != null">
			AND  fo.ORDER_DEPARTMENT =  #{orderDepartment}
		</if>
		
		<if test="id != null">
			AND  FOD.ID =  #{id}
		</if>
		<if test="beginTime != null">
			AND FOD.ENTRY_TIME&gt;= #{beginTime}
		</if>
		<if test="endTime != null">
			AND FOD.ENTRY_TIME&lt;= #{endTime}
		</if>
		<if test="orderName != null">
			AND FOD.ORDER_NAME like #{orderName}
		</if>
		<if test="channelName != null">
			AND FOD.CHANNEL_NAME like #{channelName}
		</if>
		<if test="orderDirectorName != null">
			AND FOD.ORDER_DIRECTOR_NAME like #{orderDirectorName}
		</if>
		<if test="ocDayStatus != null">
			AND  FOD.OC_DAY_STATUS =  #{ocDayStatus}
		</if>
		<if test="entryDayStatus != null">
			AND FOD.ENTRY_DAY_STATUS = #{entryDayStatus}
		</if>
		<if test="financialSubmitCpStatus != null">
			AND FACPD.FINANCIAL_SUBMIT_CP_STATUS = #{financialSubmitCpStatus}
		</if>
		<if test="financialSubmitCpNotthroughTime != null">
			AND FACPD.FINANCIAL_SUBMIT_CP_NOTTHROUGH_TIME = #{financialSubmitCpNotthroughTime}
		</if>
		<if test="financialSubmitChannelStatus != null">
			AND FACHD.FINANCIAL_SUBMIT_CHANNEL_STATUS = #{financialSubmitChannelStatus}
		</if>
		<if test="financialSubmitChannelNotthroughTime != null">
			AND FACHD.FINANCIAL_SUBMIT_CHANNEL_NOTTHROUGH_TIME = #{financialSubmitChannelNotthroughTime}
		</if>
		<if test="orderMonthStatus != null">
			AND FOD.ORDER_MONTH_STATUS = #{orderMonthStatus}
		</if>
		<if test="channelMonthStatus != null">
			AND FOD.CHANNEL_MONTH_STATUS = #{channelMonthStatus}
		</if>
			order by ENTRY_TIME desc
		<if test="LimitStart != null and LimitStart&gt;=0">
			LIMIT #{LimitStart} , #{LimitEnd}
		</if>
		
	</select>
	
	<select id="countGetAuditOcDayList" parameterType="map" resultType="java.lang.Integer">
		select count(w.id)
		from (
			SELECT
			FOD.*
		FROM
			FOS_OC_DAY FOD
			LEFT JOIN FOS_AUDIT_CP_DAY FACPD ON FOD.ID = FACPD.OC_DAY_ID
			LEFT JOIN FOS_AUDIT_CHANNEL_DAY FACHD ON FOD.ID = FACHD.OC_DAY_ID
			LEFT JOIN FOS_ORDER FO ON FOD.ORDER_ID=FO.ORDER_ID
		WHERE 1=1	
		
		<!-- 数据级控制 -->
		<if test="businessNames != null">
			AND  fod.ORDER_DIRECTOR_NAME in  ${businessNames}
		</if>
		<if test="channelNames != null">
			AND  fod.CHANNEL_DIRECTOR_NAME in  ${channelNames}
		</if>
		<if test="teamId != null">
			AND  fo.ORDER_DEPARTMENT =  #{teamId}
		</if>
		
		<if test="orderDepartment != null">
			AND  fo.ORDER_DEPARTMENT =  #{orderDepartment}
		</if>
		
		<if test="id != null">
			AND  FOD.ID =  #{id}
		</if>
		<if test="beginTime != null">
			AND FOD.ENTRY_TIME&gt;= #{beginTime}
		</if>
		<if test="endTime != null">
			AND FOD.ENTRY_TIME&lt;= #{endTime}
		</if>
		<if test="orderName != null">
			AND FOD.ORDER_NAME like #{orderName}
		</if>
		<if test="channelName != null">
			AND FOD.CHANNEL_NAME like #{channelName}
		</if>
		<if test="orderDirectorName != null">
			AND FOD.ORDER_DIRECTOR_NAME like #{orderDirectorName}
		</if>
		<if test="ocDayStatus != null">
			AND  FOD.OC_DAY_STATUS =  #{ocDayStatus}
		</if>
		<if test="entryDayStatus != null">
			AND FOD.ENTRY_DAY_STATUS = #{entryDayStatus}
		</if>
		<if test="financialSubmitCpStatus != null">
			AND FACPD.FINANCIAL_SUBMIT_CP_STATUS = #{financialSubmitCpStatus}
		</if>
		<if test="financialSubmitCpNotthroughTime != null">
			AND FACPD.FINANCIAL_SUBMIT_CP_NOTTHROUGH_TIME = #{financialSubmitCpNotthroughTime}
		</if>
		<if test="financialSubmitChannelStatus != null">
			AND FACHD.FINANCIAL_SUBMIT_CHANNEL_STATUS = #{financialSubmitChannelStatus}
		</if>
		<if test="financialSubmitChannelNotthroughTime != null">
			AND FACHD.FINANCIAL_SUBMIT_CHANNEL_NOTTHROUGH_TIME = #{financialSubmitChannelNotthroughTime}
		</if>
		<if test="orderMonthStatus != null">
			AND FOD.ORDER_MONTH_STATUS = #{orderMonthStatus}
		</if>
		<if test="channelMonthStatus != null">
			AND FOD.CHANNEL_MONTH_STATUS = #{channelMonthStatus}
		</if>
		)w
	</select>
	
	<select id="getAuditOcDayInfoSum" parameterType="map" resultType="com.imopan.adv.platform.vo.fos.FosAuditOcDayVo">
		SELECT
				sum(FOD.O_COUNT) oCount,
				sum(FOD.O_AMOUNT) oAmount,
				
				sum(FOD.C_COUNT) cCount, 
				sum(FOD.C_AMOUNT) cAmount,
				
				sum(FACPD.FINANCIAL_SUBMIT_OCOUNT) financialSubmitOcount,
				sum(FACPD.FINANCIAL_SUBMIT_OAMOUNT) financialSubmitOamount,
				
				sum(FACHD.FINANCIAL_SUBMIT_CCOUNT) financialSubmitCcount,
				sum(FACHD.FINANCIAL_SUBMIT_CAMOUNT) financialSubmitCamount
		FROM
			FOS_OC_DAY FOD
			LEFT JOIN FOS_AUDIT_CP_DAY FACPD ON FOD.ID = FACPD.OC_DAY_ID
			LEFT JOIN FOS_AUDIT_CHANNEL_DAY FACHD ON FOD.ID = FACHD.OC_DAY_ID
			LEFT JOIN FOS_ORDER FO ON FOD.ORDER_ID=FO.ORDER_ID
		WHERE 1=1	
		
		<!-- 数据级控制 -->
		<if test="businessNames != null">
			AND  fod.ORDER_DIRECTOR_NAME in  ${businessNames}
		</if>
		<if test="channelNames != null">
			AND  fod.CHANNEL_DIRECTOR_NAME in  ${channelNames}
		</if>
		<if test="teamId != null">
			AND  fo.ORDER_DEPARTMENT =  #{teamId}
		</if>
		
		<if test="orderDepartment != null">
			AND  fo.ORDER_DEPARTMENT =  #{orderDepartment}
		</if>
		
		<if test="beginTime != null">
			AND FOD.ENTRY_TIME&gt;= #{beginTime}
		</if>
		<if test="endTime != null">
			AND FOD.ENTRY_TIME&lt;= #{endTime}
		</if>
		<if test="orderName != null">
			AND FOD.ORDER_NAME like #{orderName}
		</if>
		<if test="channelName != null">
			AND FOD.CHANNEL_NAME like #{channelName}
		</if>
		<if test="orderDirectorName != null">
			AND FOD.ORDER_DIRECTOR_NAME like #{orderDirectorName}
		</if>
		<if test="ocDayStatus != null">
			AND  FOD.OC_DAY_STATUS =  #{ocDayStatus}
		</if>
		<if test="entryDayStatus != null">
			AND FOD.ENTRY_DAY_STATUS = #{entryDayStatus}
		</if>
		<if test="financialSubmitCpStatus != null">
			AND FACPD.FINANCIAL_SUBMIT_CP_STATUS = #{financialSubmitCpStatus}
		</if>
		<if test="financialSubmitCpNotthroughTime != null">
			AND FACPD.FINANCIAL_SUBMIT_CP_NOTTHROUGH_TIME = #{financialSubmitCpNotthroughTime}
		</if>
		<if test="financialSubmitChannelStatus != null">
			AND FACHD.FINANCIAL_SUBMIT_CHANNEL_STATUS = #{financialSubmitChannelStatus}
		</if>
		<if test="financialSubmitChannelNotthroughTime != null">
			AND FACHD.FINANCIAL_SUBMIT_CHANNEL_NOTTHROUGH_TIME = #{financialSubmitChannelNotthroughTime}
		</if>
		<if test="orderMonthStatus != null">
			AND FOD.ORDER_MONTH_STATUS = #{orderMonthStatus}
		</if>
		<if test="channelMonthStatus != null">
			AND FOD.CHANNEL_MONTH_STATUS = #{channelMonthStatus}
		</if>
	</select>
	
	<select id="getIncomeAndCostList" parameterType="map" resultType="com.imopan.adv.platform.vo.fos.FosAuditOcDayVo">
		SELECT
			FOD.ID id,
			FOD.ORDER_NAME orderName,
			FOD.CHANNEL_ORDER_ID channelOrderId,
			FOD.ORDER_ID orderId,
            FOD.PRODUCT_NAME productName,
            FOD.COOPERATE_NAME cooperateName,
            FOD.CHANNEL_ID channelId,
            FOD.CHANNEL_NAME channelName,
           <!--  FOD.ENTRY_TIME entryTime, -->
            #{businessTime} entryTimeStr,
            sum(FACPD.FINANCIAL_SUBMIT_OAMOUNT) financialSubmitOamount,
            sum(FACHD.FINANCIAL_SUBMIT_CAMOUNT+FOD.AVG_MEDIA_REBATE+FOD.AVG_OTHER_EXPENSE-FOD.AVG_CHANNEL_CUT) financialSubmitCamount,
			FORDER.EXTEND_TYPE extendType,
			FIC.MONEY_TAX moneyTax,
			FIC.PROFIT profit,
			FIC.PROFIT_MARGIN profitMargin,
			CINFO.FULL_NAME fullName,
			FORDER.ORDER_DEPARTMENT orderDepartment
		FROM
			FOS_OC_DAY FOD
			LEFT JOIN FOS_AUDIT_CP_DAY FACPD ON FOD.ID = FACPD.OC_DAY_ID
			LEFT JOIN FOS_AUDIT_CHANNEL_DAY FACHD ON FOD.ID = FACHD.OC_DAY_ID
            LEFT JOIN FOS_ORDER FORDER ON FOD.ORDER_ID = FORDER.ORDER_ID
            LEFT JOIN CHANNEL_INFO_V2 CINFO ON FOD.CHANNEL_ID = CINFO.ID
            LEFT JOIN FOS_INCOME_COST FIC ON FOD.CHANNEL_ORDER_ID = FIC.CHANNEL_ORDER_ID AND FIC.BUSINESS_TIME = #{businessTime}
		WHERE 1=1	
		    <!-- AND FACPD.FINANCIAL_SUBMIT_CP_STATUS = 3
            AND FACHD.FINANCIAL_SUBMIT_CHANNEL_STATUS =3 -->
            
            <!-- 数据级控制 -->
		<if test="businessNames != null">
			AND  fod.ORDER_DIRECTOR_NAME in  ${businessNames}
		</if>
		<if test="channelNames != null">
			AND  fod.CHANNEL_DIRECTOR_NAME in  ${channelNames}
		</if>
		<if test="teamId != null">
			AND  FORDER.ORDER_DEPARTMENT =  #{teamId}
		</if>
            
        <if test="orderDepartment != null">
			AND  FORDER.ORDER_DEPARTMENT =  #{orderDepartment}
		</if>
            
		<if test="beginTime != null">
			AND FOD.ENTRY_TIME&gt;= #{beginTime}
		</if>
		<if test="endTime != null">
			AND FOD.ENTRY_TIME&lt;= #{endTime}
		</if>
		<if test="orderName != null">
			AND FOD.ORDER_NAME like #{orderName}
		</if>
		<if test="channelName != null">
			AND FOD.CHANNEL_NAME like #{channelName}
		</if>
		<if test="orderDirectorName != null">
			AND FOD.ORDER_DIRECTOR_NAME like #{orderDirectorName}
		</if>
		<if test="ocDayStatus != null">
			AND  FOD.OC_DAY_STATUS =  #{ocDayStatus}
		</if>
		<if test="entryDayStatus != null">
			AND FOD.ENTRY_DAY_STATUS = #{entryDayStatus}
		</if>
		<if test="financialSubmitCpStatus != null">
			AND FACPD.FINANCIAL_SUBMIT_CP_STATUS = #{financialSubmitCpStatus}
		</if>
		<if test="financialSubmitCpNotthroughTime != null">
			AND FACPD.FINANCIAL_SUBMIT_CP_NOTTHROUGH_TIME = #{financialSubmitCpNotthroughTime}
		</if>
		<if test="financialSubmitChannelStatus != null">
			AND FACHD.FINANCIAL_SUBMIT_CHANNEL_STATUS = #{financialSubmitChannelStatus}
		</if>
		<if test="financialSubmitChannelNotthroughTime != null">
			AND FACHD.FINANCIAL_SUBMIT_CHANNEL_NOTTHROUGH_TIME = #{financialSubmitChannelNotthroughTime}
		</if>
		
		    GROUP BY FOD.CHANNEL_ORDER_ID
		    
		<if test="LimitStart != null and LimitStart&gt;=0">
			LIMIT #{LimitStart} , #{LimitEnd}
		</if>
	</select>
	
	<select id="countGetIncomeAndCostList" parameterType="map" resultType="java.lang.Integer">
		select count(w.id)
		from (
			SELECT
			FOD.*
		FROM
			FOS_OC_DAY FOD
			LEFT JOIN FOS_AUDIT_CP_DAY FACPD ON FOD.ID = FACPD.OC_DAY_ID
			LEFT JOIN FOS_AUDIT_CHANNEL_DAY FACHD ON FOD.ID = FACHD.OC_DAY_ID
            LEFT JOIN FOS_ORDER FORDER ON FOD.ORDER_ID = FORDER.ORDER_ID
            LEFT JOIN CHANNEL_INFO_V2 CINFO ON FOD.CHANNEL_ID = CINFO.ID
		WHERE 1=1	
		
		 <!-- 数据级控制 -->
		<if test="businessNames != null">
			AND  fod.ORDER_DIRECTOR_NAME in  ${businessNames}
		</if>
		<if test="channelNames != null">
			AND  fod.CHANNEL_DIRECTOR_NAME in  ${channelNames}
		</if>
		<if test="teamId != null">
			AND  FORDER.ORDER_DEPARTMENT =  #{teamId}
		</if>
		
		 <if test="orderDepartment != null">
			AND  FORDER.ORDER_DEPARTMENT =  #{orderDepartment}
		</if>
		
		    <!-- AND FACPD.FINANCIAL_SUBMIT_CP_STATUS = 3
            AND FACHD.FINANCIAL_SUBMIT_CHANNEL_STATUS =3 -->
		<if test="beginTime != null">
			AND FOD.ENTRY_TIME&gt;= #{beginTime}
		</if>
		<if test="endTime != null">
			AND FOD.ENTRY_TIME&lt;= #{endTime}
		</if>
		<if test="orderName != null">
			AND FOD.ORDER_NAME like #{orderName}
		</if>
		<if test="channelName != null">
			AND FOD.CHANNEL_NAME like #{channelName}
		</if>
		<if test="orderDirectorName != null">
			AND FOD.ORDER_DIRECTOR_NAME like #{orderDirectorName}
		</if>
		<if test="ocDayStatus != null">
			AND  FOD.OC_DAY_STATUS =  #{ocDayStatus}
		</if>
		<if test="entryDayStatus != null">
			AND FOD.ENTRY_DAY_STATUS = #{entryDayStatus}
		</if>
		<if test="financialSubmitCpStatus != null">
			AND FACPD.FINANCIAL_SUBMIT_CP_STATUS = #{financialSubmitCpStatus}
		</if>
		<if test="financialSubmitCpNotthroughTime != null">
			AND FACPD.FINANCIAL_SUBMIT_CP_NOTTHROUGH_TIME = #{financialSubmitCpNotthroughTime}
		</if>
		<if test="financialSubmitChannelStatus != null">
			AND FACHD.FINANCIAL_SUBMIT_CHANNEL_STATUS = #{financialSubmitChannelStatus}
		</if>
		<if test="financialSubmitChannelNotthroughTime != null">
			AND FACHD.FINANCIAL_SUBMIT_CHANNEL_NOTTHROUGH_TIME = #{financialSubmitChannelNotthroughTime}
		</if>
		 GROUP BY CHANNEL_ORDER_ID
		)w
	</select>
	
	<select id="getOcDayList" parameterType="map" resultMap="BaseResultMap">
		select
    		fod.*
    	FROM
			fos_oc_day fod
			LEFT JOIN fos_order fo ON fod.ORDER_ID = fo.ORDER_ID
		where 1=1
		
		<!-- 数据级控制 -->
		<if test="businessNames != null">
			AND  fod.ORDER_DIRECTOR_NAME in  ${businessNames}
		</if>
		<if test="channelNames != null">
			AND  fod.CHANNEL_DIRECTOR_NAME in  ${channelNames}
		</if>
		<if test="teamId != null">
			AND  fo.ORDER_DEPARTMENT =  #{teamId}
		</if>
		
		<if test="entryDayStatus != null">
			AND  FOD.ENTRY_DAY_STATUS =  #{entryDayStatus}
		</if>
		<if test="id != null">
			AND  FOD.id =  #{id}
		</if>
		<if test="orderName != null">
			AND FOD.ORDER_NAME like #{orderName}
		</if>
		<if test="orderDirectorName != null">
			AND FOD.ORDER_DIRECTOR_NAME like #{orderDirectorName}
		</if>
		<if test="channelName != null">
			AND FOD.CHANNEL_NAME like #{channelName}
		</if>
		<if test="beginTime != null">
			AND FOD.ENTRY_TIME&gt;= #{beginTime}
		</if>
		<if test="endTime != null">
			AND FOD.ENTRY_TIME&lt;= #{endTime}
		</if>
		
		<if test="orderBy != null">
			ORDER BY FOD.${orderBy}
		</if>
		<if test="LimitStart != null and LimitStart&gt;=0">
			LIMIT #{LimitStart} , #{LimitEnd}
		</if>
	</select>
	<select id="countGetOcDayList" parameterType="map" resultType="java.lang.Integer">
		select count(*)
		from (
			select
    			fod.*
    	FROM
			fos_oc_day fod
			LEFT JOIN fos_order fo ON fod.ORDER_ID = fo.ORDER_ID
		where 1=1
		
		<!-- 数据级控制 -->
		<if test="businessNames != null">
			AND  fod.ORDER_DIRECTOR_NAME in  ${businessNames}
		</if>
		<if test="channelNames != null">
			AND  fod.CHANNEL_DIRECTOR_NAME in  ${channelNames}
		</if>
		<if test="teamId != null">
			AND  fo.ORDER_DEPARTMENT =  #{teamId}
		</if>
		
		<if test="entryDayStatus != null">
			AND  FOD.ENTRY_DAY_STATUS =  #{entryDayStatus}
		</if>
		<if test="id != null">
			AND  FOD.id =  #{id}
		</if>
		<if test="orderName != null">
			AND FOD.ORDER_NAME like #{orderName}
		</if>
		<if test="orderDirectorName != null">
			AND FOD.ORDER_DIRECTOR_NAME like #{orderDirectorName}
		</if>
		<if test="channelName != null">
			AND FOD.CHANNEL_NAME like #{channelName}
		</if>
		<if test="beginTime != null">
			AND FOD.ENTRY_TIME&gt;= #{beginTime}
		</if>
		<if test="endTime != null">
			AND FOD.ENTRY_TIME&lt;= #{endTime}
		</if>
		)w
	</select>
	
	<update id="updateChannelMonthStatus" parameterType="map" >
		update fos_oc_day fod left join fos_audit_channel_day facd on fod.ID=facd.OC_DAY_ID set fod.CHANNEL_MONTH_STATUS=1 where 1=1 
		<if test="channelOrderId != null">
			AND FOD.CHANNEL_ORDER_ID = #{channelOrderId}
		</if>
		<if test="entryDayStatus != null">
			AND FOD.ENTRY_DAY_STATUS = #{entryDayStatus}
		</if>
		<if test="ocDayStatus != null">
			AND FOD.OC_DAY_STATUS = #{ocDayStatus}
		</if>
		<if test="financialSubmitChannelStatus != null">
			AND facd.FINANCIAL_SUBMIT_CHANNEL_STATUS = #{financialSubmitChannelStatus}
		</if>
		<if test="entryBegintime != null">
			AND FOD.ENTRY_TIME&gt;= #{entryBegintime}
		</if>
		<if test="entryEndtime != null">
			AND FOD.ENTRY_TIME&lt;= #{entryEndtime}
		</if>
		
	</update>
	
	<update id="updateOrderMonthStatus" parameterType="map" >
		update fos_oc_day fod left join fos_audit_cp_day facd on fod.ID=facd.OC_DAY_ID set fod.ORDER_MONTH_STATUS=1 where 1=1 
		<if test="orderId != null">
			AND FOD.ORDER_ID = #{orderId}
		</if>
		<if test="entryDayStatus != null">
			AND FOD.ENTRY_DAY_STATUS = #{entryDayStatus}
		</if>
		<if test="ocDayStatus != null">
			AND FOD.OC_DAY_STATUS = #{ocDayStatus}
		</if>
		<if test="financialSubmitCpStatus != null">
			AND facd.FINANCIAL_SUBMIT_CP_STATUS = #{financialSubmitCpStatus}
		</if>
		<if test="entryBegintime != null">
			AND FOD.ENTRY_TIME&gt;= #{entryBegintime}
		</if>
		<if test="entryEndtime != null">
			AND FOD.ENTRY_TIME&lt;= #{entryEndtime}
		</if>
		
	</update>
	
	
	
</mapper>